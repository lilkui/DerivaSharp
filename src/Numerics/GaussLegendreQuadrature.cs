namespace DerivaSharp.Numerics;

/// <summary>
///     Gauss-Legendre quadrature for approximating definite integrals.
/// </summary>
public static class GaussLegendreQuadrature
{
    private static readonly Dictionary<int, Point> s_precomputedPoints = new()
    {
        // Even
        {
            2, new Point(
                2,
                [0.5773502691896257645091488],
                [1.0000000000000000000000000])
        },
        {
            4, new Point(
                4,
                [0.3399810435848562648026658, 0.8611363115940525752239465],
                [0.6521451548625461426269361, 0.3478548451374538573730639])
        },
        {
            6, new Point(
                6,
                [0.2386191860831969086305017, 0.6612093864662645136613996, 0.9324695142031520278123016],
                [0.4679139345726910473898703, 0.3607615730481386075698335, 0.1713244923791703450402961])
        },
        {
            8, new Point(
                8,
                [0.1834346424956498049394761, 0.5255324099163289858177390, 0.7966664774136267395915539, 0.9602898564975362316835609],
                [0.3626837833783619829651504, 0.3137066458778872873379622, 0.2223810344533744705443560, 0.1012285362903762591525314])
        },
        {
            10, new Point(
                10,
                [0.1488743389816312108848260, 0.4333953941292471907992659, 0.6794095682990244062343274, 0.8650633666889845107320967, 0.9739065285171717200779640],
                [0.2955242247147528701738930, 0.2692667193099963550912269, 0.2190863625159820439955349, 0.1494513491505805931457763, 0.0666713443086881375935688])
        },
        {
            12, new Point(
                12,
                [
                    0.1252334085114689154724414,
                    0.3678314989981801937526915,
                    0.5873179542866174472967024,
                    0.7699026741943046870368938,
                    0.9041172563704748566784659,
                    0.9815606342467192506905491,
                ],
                [
                    0.2491470458134027850005624,
                    0.2334925365383548087608499,
                    0.2031674267230659217490645,
                    0.1600783285433462263346525,
                    0.1069393259953184309602547,
                    0.0471753363865118271946160,
                ])
        },
        {
            14, new Point(
                14,
                [
                    0.1080549487073436620662447,
                    0.3191123689278897604356718,
                    0.5152486363581540919652907,
                    0.6872929048116854701480198,
                    0.8272013150697649931897947,
                    0.9284348836635735173363911,
                    0.9862838086968123388415973,
                ],
                [
                    0.2152638534631577901958764,
                    0.2051984637212956039659241,
                    0.1855383974779378137417166,
                    0.1572031671581935345696019,
                    0.1215185706879031846894148,
                    0.0801580871597602098056333,
                    0.0351194603317518630318329,
                ])
        },
        {
            16, new Point(
                16,
                [
                    0.0950125098376374401853193,
                    0.2816035507792589132304605,
                    0.4580167776572273863424194,
                    0.6178762444026437484466718,
                    0.7554044083550030338951012,
                    0.8656312023878317438804679,
                    0.9445750230732325760779884,
                    0.9894009349916499325961542,
                ],
                [
                    0.1894506104550684962853967,
                    0.1826034150449235888667637,
                    0.1691565193950025381893121,
                    0.1495959888165767320815017,
                    0.1246289712555338720524763,
                    0.0951585116824927848099251,
                    0.0622535239386478928628438,
                    0.0271524594117540948517806,
                ])
        },
        {
            18, new Point(
                18,
                [
                    0.0847750130417353012422619,
                    0.2518862256915055095889729,
                    0.4117511614628426460359318,
                    0.5597708310739475346078715,
                    0.6916870430603532078748911,
                    0.8037049589725231156824175,
                    0.8926024664975557392060606,
                    0.9558239495713977551811959,
                    0.9915651684209309467300160,
                ],
                [
                    0.1691423829631435918406565,
                    0.1642764837458327229860538,
                    0.1546846751262652449254180,
                    0.1406429146706506512047313,
                    0.1225552067114784601845191,
                    0.1009420441062871655628140,
                    0.0764257302548890565291297,
                    0.0497145488949697964533349,
                    0.0216160135264833103133427,
                ])
        },
        {
            20, new Point(
                20,
                [
                    0.0765265211334973337546404,
                    0.2277858511416450780804962,
                    0.3737060887154195606725482,
                    0.5108670019508270980043641,
                    0.6360536807265150254528367,
                    0.7463319064601507926143051,
                    0.8391169718222188233945291,
                    0.9122344282513259058677524,
                    0.9639719272779137912676661,
                    0.9931285991850949247861224,
                ],
                [
                    0.1527533871307258506980843,
                    0.1491729864726037467878287,
                    0.1420961093183820513292983,
                    0.1316886384491766268984945,
                    0.1181945319615184173123774,
                    0.1019301198172404350367501,
                    0.0832767415767047487247581,
                    0.0626720483341090635695065,
                    0.0406014298003869413310400,
                    0.0176140071391521183118620,
                ])
        },
        {
            32, new Point(
                32,
                [
                    0.0483076656877383162348126,
                    0.1444719615827964934851864,
                    0.2392873622521370745446032,
                    0.3318686022821276497799168,
                    0.4213512761306353453641194,
                    0.5068999089322293900237475,
                    0.5877157572407623290407455,
                    0.6630442669302152009751152,
                    0.7321821187402896803874267,
                    0.7944837959679424069630973,
                    0.8493676137325699701336930,
                    0.8963211557660521239653072,
                    0.9349060759377396891709191,
                    0.9647622555875064307738119,
                    0.9856115115452683354001750,
                    0.9972638618494815635449811,
                ],
                [
                    0.0965400885147278005667648,
                    0.0956387200792748594190820,
                    0.0938443990808045656391802,
                    0.0911738786957638847128686,
                    0.0876520930044038111427715,
                    0.0833119242269467552221991,
                    0.0781938957870703064717409,
                    0.0723457941088485062253994,
                    0.0658222227763618468376501,
                    0.0586840934785355471452836,
                    0.0509980592623761761961632,
                    0.0428358980222266806568786,
                    0.0342738629130214331026877,
                    0.0253920653092620594557526,
                    0.0162743947309056706051706,
                    0.0070186100094700966004071,
                ])
        },
        {
            64, new Point(
                64,
                [
                    0.0243502926634244325089558,
                    0.0729931217877990394495429,
                    0.1214628192961205544703765,
                    0.1696444204239928180373136,
                    0.2174236437400070841496487,
                    0.2646871622087674163739642,
                    0.3113228719902109561575127,
                    0.3572201583376681159504426,
                    0.4022701579639916036957668,
                    0.4463660172534640879849477,
                    0.4894031457070529574785263,
                    0.5312794640198945456580139,
                    0.5718956462026340342838781,
                    0.6111553551723932502488530,
                    0.6489654712546573398577612,
                    0.6852363130542332425635584,
                    0.7198818501716108268489402,
                    0.7528199072605318966118638,
                    0.7839723589433414076102205,
                    0.8132653151227975597419233,
                    0.8406292962525803627516915,
                    0.8659993981540928197607834,
                    0.8893154459951141058534040,
                    0.9105221370785028057563807,
                    0.9295691721319395758214902,
                    0.9464113748584028160624815,
                    0.9610087996520537189186141,
                    0.9733268277899109637418535,
                    0.9833362538846259569312993,
                    0.9910133714767443207393824,
                    0.9963401167719552793469245,
                    0.9993050417357721394569056,
                ],
                [
                    0.0486909570091397203833654,
                    0.0485754674415034269347991,
                    0.0483447622348029571697695,
                    0.0479993885964583077281262,
                    0.0475401657148303086622822,
                    0.0469681828162100173253263,
                    0.0462847965813144172959532,
                    0.0454916279274181444797710,
                    0.0445905581637565630601347,
                    0.0435837245293234533768279,
                    0.0424735151236535890073398,
                    0.0412625632426235286101563,
                    0.0399537411327203413866569,
                    0.0385501531786156291289625,
                    0.0370551285402400460404151,
                    0.0354722132568823838106931,
                    0.0338051618371416093915655,
                    0.0320579283548515535854675,
                    0.0302346570724024788679741,
                    0.0283396726142594832275113,
                    0.0263774697150546586716918,
                    0.0243527025687108733381776,
                    0.0222701738083832541592983,
                    0.0201348231535302093723403,
                    0.0179517157756973430850453,
                    0.0157260304760247193219660,
                    0.0134630478967186425980608,
                    0.0111681394601311288185905,
                    0.0088467598263639477230309,
                    0.0065044579689783628561174,
                    0.0041470332605624676352875,
                    0.0017832807216964329472961,
                ])
        },
        {
            96, new Point(
                96,
                [
                    0.0162767448496029695791346,
                    0.0488129851360497311119582,
                    0.0812974954644255589944713,
                    0.1136958501106659209112081,
                    0.1459737146548969419891073,
                    0.1780968823676186027594026,
                    0.2100313104605672036028472,
                    0.2417431561638400123279319,
                    0.2731988125910491414872722,
                    0.3043649443544963530239298,
                    0.3352085228926254226163256,
                    0.3656968614723136350308956,
                    0.3957976498289086032850002,
                    0.4254789884073005453648192,
                    0.4547094221677430086356761,
                    0.4834579739205963597684056,
                    0.5116941771546676735855097,
                    0.5393881083243574362268026,
                    0.5665104185613971684042502,
                    0.5930323647775720806835558,
                    0.6189258401254685703863693,
                    0.6441634037849671067984124,
                    0.6687183100439161539525572,
                    0.6925645366421715613442458,
                    0.7156768123489676262251441,
                    0.7380306437444001328511657,
                    0.7596023411766474987029704,
                    0.7803690438674332176036045,
                    0.8003087441391408172287961,
                    0.8194003107379316755389996,
                    0.8376235112281871214943028,
                    0.8549590334346014554627870,
                    0.8713885059092965028737748,
                    0.8868945174024204160568774,
                    0.9014606353158523413192327,
                    0.9150714231208980742058845,
                    0.9277124567223086909646905,
                    0.9393703397527552169318574,
                    0.9500327177844376357560989,
                    0.9596882914487425393000680,
                    0.9683268284632642121736594,
                    0.9759391745851364664526010,
                    0.9825172635630146774470458,
                    0.9880541263296237994807628,
                    0.9925439003237626245718923,
                    0.9959818429872092906503991,
                    0.9983643758631816777241494,
                    0.9996895038832307668276901,
                ],
                [
                    0.0325506144923631662419614,
                    0.0325161187138688359872055,
                    0.0324471637140642693640128,
                    0.0323438225685759284287748,
                    0.0322062047940302506686671,
                    0.0320344562319926632181390,
                    0.0318287588944110065347537,
                    0.0315893307707271685580207,
                    0.0313164255968613558127843,
                    0.0310103325863138374232498,
                    0.0306713761236691490142288,
                    0.0302999154208275937940888,
                    0.0298963441363283859843881,
                    0.0294610899581679059704363,
                    0.0289946141505552365426788,
                    0.0284974110650853856455995,
                    0.0279700076168483344398186,
                    0.0274129627260292428234211,
                    0.0268268667255917621980567,
                    0.0262123407356724139134580,
                    0.0255700360053493614987972,
                    0.0249006332224836102883822,
                    0.0242048417923646912822673,
                    0.0234833990859262198422359,
                    0.0227370696583293740013478,
                    0.0219666444387443491947564,
                    0.0211729398921912989876739,
                    0.0203567971543333245952452,
                    0.0195190811401450224100852,
                    0.0186606796274114673851568,
                    0.0177825023160452608376142,
                    0.0168854798642451724504775,
                    0.0159705629025622913806165,
                    0.0150387210269949380058763,
                    0.0140909417723148609158616,
                    0.0131282295669615726370637,
                    0.0121516046710883196351814,
                    0.0111621020998384985912133,
                    0.0101607705350084157575876,
                    0.0091486712307833866325846,
                    0.0081268769256987592173824,
                    0.0070964707911538652691442,
                    0.0060585455042359616833167,
                    0.0050142027429275176924702,
                    0.0039645543384446866737334,
                    0.0029107318179349464084106,
                    0.0018539607889469217323359,
                    0.0007967920655520124294381,
                ])
        },
        {
            100, new Point(
                100,
                [
                    0.0156289844215430828722167,
                    0.0468716824215916316149239,
                    0.0780685828134366366948174,
                    0.1091892035800611150034260,
                    0.1402031372361139732075146,
                    0.1710800805386032748875324,
                    0.2017898640957359972360489,
                    0.2323024818449739696495100,
                    0.2625881203715034791689293,
                    0.2926171880384719647375559,
                    0.3223603439005291517224766,
                    0.3517885263724217209723438,
                    0.3808729816246299567633625,
                    0.4095852916783015425288684,
                    0.4378974021720315131089780,
                    0.4657816497733580422492166,
                    0.4932107892081909335693088,
                    0.5201580198817630566468157,
                    0.5465970120650941674679943,
                    0.5725019326213811913168704,
                    0.5978474702471787212648065,
                    0.6226088602037077716041908,
                    0.6467619085141292798326303,
                    0.6702830156031410158025870,
                    0.6931491993558019659486479,
                    0.7153381175730564464599671,
                    0.7368280898020207055124277,
                    0.7575981185197071760356680,
                    0.7776279096494954756275514,
                    0.7968978923903144763895729,
                    0.8153892383391762543939888,
                    0.8330838798884008235429158,
                    0.8499645278795912842933626,
                    0.8660146884971646234107400,
                    0.8812186793850184155733168,
                    0.8955616449707269866985210,
                    0.9090295709825296904671263,
                    0.9216092981453339526669513,
                    0.9332885350430795459243337,
                    0.9440558701362559779627747,
                    0.9539007829254917428493369,
                    0.9628136542558155272936593,
                    0.9707857757637063319308979,
                    0.9778093584869182885537811,
                    0.9838775407060570154961002,
                    0.9889843952429917480044187,
                    0.9931249370374434596520099,
                    0.9962951347331251491861317,
                    0.9984919506395958184001634,
                    0.9997137267734412336782285,
                ],
                [
                    0.0312554234538633569476425,
                    0.0312248842548493577323765,
                    0.0311638356962099067838183,
                    0.0310723374275665165878102,
                    0.0309504788504909882340635,
                    0.0307983790311525904277139,
                    0.0306161865839804484964594,
                    0.0304040795264548200165079,
                    0.0301622651051691449190687,
                    0.0298909795933328309168368,
                    0.0295904880599126425117545,
                    0.0292610841106382766201190,
                    0.0289030896011252031348762,
                    0.0285168543223950979909368,
                    0.0281027556591011733176483,
                    0.0276611982207923882942042,
                    0.0271926134465768801364916,
                    0.0266974591835709626603847,
                    0.0261762192395456763423087,
                    0.0256294029102081160756420,
                    0.0250575444815795897037642,
                    0.0244612027079570527199750,
                    0.0238409602659682059625604,
                    0.0231974231852541216224889,
                    0.0225312202563362727017970,
                    0.0218430024162473863139537,
                    0.0211334421125276415426723,
                    0.0204032326462094327668389,
                    0.0196530874944353058653815,
                    0.0188837396133749045529412,
                    0.0180959407221281166643908,
                    0.0172904605683235824393442,
                    0.0164680861761452126431050,
                    0.0156296210775460027239369,
                    0.0147758845274413017688800,
                    0.0139077107037187726879541,
                    0.0130259478929715422855586,
                    0.0121314576629794974077448,
                    0.0112251140231859771172216,
                    0.0103078025748689695857821,
                    0.0093804196536944579514182,
                    0.0084438714696689714026208,
                    0.0074990732554647115788287,
                    0.0065469484508453227641521,
                    0.0055884280038655151572119,
                    0.0046244500634221193510958,
                    0.0036559612013263751823425,
                    0.0026839253715534824194396,
                    0.0017093926535181052395294,
                    0.0007346344905056717304063,
                ])
        },
        {
            128, new Point(
                128,
                [
                    0.0122236989606157641980521,
                    0.0366637909687334933302153,
                    0.0610819696041395681037870,
                    0.0854636405045154986364980,
                    0.1097942311276437466729747,
                    0.1340591994611877851175753,
                    0.1582440427142249339974755,
                    0.1823343059853371824103826,
                    0.2063155909020792171540580,
                    0.2301735642266599864109866,
                    0.2538939664226943208556180,
                    0.2774626201779044028062316,
                    0.3008654388776772026671541,
                    0.3240884350244133751832523,
                    0.3471177285976355084261628,
                    0.3699395553498590266165917,
                    0.3925402750332674427356482,
                    0.4149063795522750154922739,
                    0.4370245010371041629370429,
                    0.4588814198335521954490891,
                    0.4804640724041720258582757,
                    0.5017595591361444642896063,
                    0.5227551520511754784539479,
                    0.5434383024128103634441936,
                    0.5637966482266180839144308,
                    0.5838180216287630895500389,
                    0.6034904561585486242035732,
                    0.6228021939105849107615396,
                    0.6417416925623075571535249,
                    0.6602976322726460521059468,
                    0.6784589224477192593677557,
                    0.6962147083695143323850866,
                    0.7135543776835874133438599,
                    0.7304675667419088064717369,
                    0.7469441667970619811698824,
                    0.7629743300440947227797691,
                    0.7785484755064119668504941,
                    0.7936572947621932902433329,
                    0.8082917575079136601196422,
                    0.8224431169556438424645942,
                    0.8361029150609068471168753,
                    0.8492629875779689691636001,
                    0.8619154689395484605906323,
                    0.8740527969580317986954180,
                    0.8856677173453972174082924,
                    0.8967532880491581843864474,
                    0.9073028834017568139214859,
                    0.9173101980809605370364836,
                    0.9267692508789478433346245,
                    0.9356743882779163757831268,
                    0.9440202878302201821211114,
                    0.9518019613412643862177963,
                    0.9590147578536999280989185,
                    0.9656543664319652686458290,
                    0.9717168187471365809043384,
                    0.9771984914639073871653744,
                    0.9820961084357185360247656,
                    0.9864067427245862088712355,
                    0.9901278184917343833379303,
                    0.9932571129002129353034372,
                    0.9957927585349811868641612,
                    0.9977332486255140198821574,
                    0.9990774599773758950119878,
                    0.9998248879471319144736081,
                ],
                [
                    0.0244461801962625182113259,
                    0.0244315690978500450548486,
                    0.0244023556338495820932980,
                    0.0243585572646906258532685,
                    0.0243002001679718653234426,
                    0.0242273192228152481200933,
                    0.0241399579890192849977167,
                    0.0240381686810240526375873,
                    0.0239220121367034556724504,
                    0.0237915577810034006387807,
                    0.0236468835844476151436514,
                    0.0234880760165359131530253,
                    0.0233152299940627601224157,
                    0.0231284488243870278792979,
                    0.0229278441436868469204110,
                    0.0227135358502364613097126,
                    0.0224856520327449668718246,
                    0.0222443288937997651046291,
                    0.0219897106684604914341221,
                    0.0217219495380520753752610,
                    0.0214412055392084601371119,
                    0.0211476464682213485370195,
                    0.0208414477807511491135839,
                    0.0205227924869600694322850,
                    0.0201918710421300411806732,
                    0.0198488812328308622199444,
                    0.0194940280587066028230219,
                    0.0191275236099509454865185,
                    0.0187495869405447086509195,
                    0.0183604439373313432212893,
                    0.0179603271850086859401969,
                    0.0175494758271177046487069,
                    0.0171281354231113768306810,
                    0.0166965578015892045890915,
                    0.0162550009097851870516575,
                    0.0158037286593993468589656,
                    0.0153430107688651440859909,
                    0.0148731226021473142523855,
                    0.0143943450041668461768239,
                    0.0139069641329519852442880,
                    0.0134112712886163323144890,
                    0.0129075627392673472204428,
                    0.0123961395439509229688217,
                    0.0118773073727402795758911,
                    0.0113513763240804166932817,
                    0.0108186607395030762476596,
                    0.0102794790158321571332153,
                    0.0097341534150068058635483,
                    0.0091830098716608743344787,
                    0.0086263777986167497049788,
                    0.0080645898904860579729286,
                    0.0074979819256347286876720,
                    0.0069268925668988135634267,
                    0.0063516631617071887872143,
                    0.0057726375428656985893346,
                    0.0051901618326763302050708,
                    0.0046045842567029551182905,
                    0.0040162549837386423131943,
                    0.0034255260409102157743378,
                    0.0028327514714579910952857,
                    0.0022382884309626187436221,
                    0.0016425030186690295387909,
                    0.0010458126793403487793129,
                    0.0004493809602920903763943,
                ])
        },

        // Odd
        {
            3, new Point(
                3,
                [0.0000000000000000000000000, 0.7745966692414833770358531],
                [0.8888888888888888888888889, 0.5555555555555555555555556])
        },
        {
            5, new Point(
                5,
                [0.0000000000000000000000000, 0.5384693101056830910363144, 0.9061798459386639927976269],
                [0.5688888888888888888888889, 0.4786286704993664680412915, 0.2369268850561890875142640])
        },
        {
            7, new Point(
                7,
                [0.0000000000000000000000000, 0.4058451513773971669066064, 0.7415311855993944398638648, 0.9491079123427585245261897],
                [0.4179591836734693877551020, 0.3818300505051189449503698, 0.2797053914892766679014678, 0.1294849661688696932706114])
        },
        {
            9, new Point(
                9,
                [0.0000000000000000000000000, 0.3242534234038089290385380, 0.6133714327005903973087020, 0.8360311073266357942994298, 0.9681602395076260898355762],
                [0.3302393550012597631645251, 0.3123470770400028400686304, 0.2606106964029354623187429, 0.1806481606948574040584720, 0.0812743883615744119718922])
        },
        {
            11, new Point(
                11,
                [
                    0.0000000000000000000000000,
                    0.2695431559523449723315320,
                    0.5190961292068118159257257,
                    0.7301520055740493240934163,
                    0.8870625997680952990751578,
                    0.9782286581460569928039380,
                ],
                [
                    0.2729250867779006307144835,
                    0.2628045445102466621806889,
                    0.2331937645919904799185237,
                    0.1862902109277342514260976,
                    0.1255803694649046246346943,
                    0.0556685671161736664827537,
                ])
        },
        {
            13, new Point(
                13,
                [
                    0.0000000000000000000000000,
                    0.2304583159551347940655281,
                    0.4484927510364468528779129,
                    0.6423493394403402206439846,
                    0.8015780907333099127942065,
                    0.9175983992229779652065478,
                    0.9841830547185881494728294,
                ],
                [
                    0.2325515532308739101945895,
                    0.2262831802628972384120902,
                    0.2078160475368885023125232,
                    0.1781459807619457382800467,
                    0.1388735102197872384636018,
                    0.0921214998377284479144218,
                    0.0404840047653158795200216,
                ])
        },
        {
            15, new Point(
                15,
                [
                    0.0000000000000000000000000,
                    0.2011940939974345223006283,
                    0.3941513470775633698972074,
                    0.5709721726085388475372267,
                    0.7244177313601700474161861,
                    0.8482065834104272162006483,
                    0.9372733924007059043077589,
                    0.9879925180204854284895657,
                ],
                [
                    0.2025782419255612728806202,
                    0.1984314853271115764561183,
                    0.1861610000155622110268006,
                    0.1662692058169939335532009,
                    0.1395706779261543144478048,
                    0.1071592204671719350118695,
                    0.0703660474881081247092674,
                    0.0307532419961172683546284,
                ])
        },
        {
            17, new Point(
                17,
                [
                    0.0000000000000000000000000,
                    0.1784841814958478558506775,
                    0.3512317634538763152971855,
                    0.5126905370864769678862466,
                    0.6576711592166907658503022,
                    0.7815140038968014069252301,
                    0.8802391537269859021229557,
                    0.9506755217687677612227170,
                    0.9905754753144173356754340,
                ],
                [
                    0.1794464703562065254582656,
                    0.1765627053669926463252710,
                    0.1680041021564500445099707,
                    0.1540457610768102880814316,
                    0.1351363684685254732863200,
                    0.1118838471934039710947884,
                    0.0850361483171791808835354,
                    0.0554595293739872011294402,
                    0.0241483028685479319601100,
                ])
        },
        {
            19, new Point(
                19,
                [
                    0.0000000000000000000000000,
                    0.1603586456402253758680961,
                    0.3165640999636298319901173,
                    0.4645707413759609457172671,
                    0.6005453046616810234696382,
                    0.7209661773352293786170959,
                    0.8227146565371428249789225,
                    0.9031559036148179016426609,
                    0.9602081521348300308527788,
                    0.9924068438435844031890177,
                ],
                [
                    0.1610544498487836959791636,
                    0.1589688433939543476499564,
                    0.1527660420658596667788554,
                    0.1426067021736066117757461,
                    0.1287539625393362276755158,
                    0.1115666455473339947160239,
                    0.0914900216224499994644621,
                    0.0690445427376412265807083,
                    0.0448142267656996003328382,
                    0.0194617882297264770363120,
                ])
        },
    };

    private static readonly double[] s_legendreLookupTable =
    [
        0.00000000000000000000,
        0.00000000000000000000,
        0.50000000000000000000,
        0.66666666666666674000,
        0.75000000000000000000,
        0.80000000000000004000,
        0.83333333333333337000,
        0.85714285714285721000,
        0.87500000000000000000,
        0.88888888888888884000,
        0.90000000000000002000,
        0.90909090909090906000,
        0.91666666666666663000,
        0.92307692307692313000,
        0.92857142857142860000,
        0.93333333333333335000,
        0.93750000000000000000,
        0.94117647058823528000,
        0.94444444444444442000,
        0.94736842105263164000,
        0.94999999999999996000,
        0.95238095238095233000,
        0.95454545454545459000,
        0.95652173913043481000,
        0.95833333333333337000,
        0.95999999999999996000,
        0.96153846153846156000,
        0.96296296296296302000,
        0.96428571428571430000,
        0.96551724137931039000,
        0.96666666666666667000,
        0.96774193548387100000,
        0.96875000000000000000,
        0.96969696969696972000,
        0.97058823529411764000,
        0.97142857142857142000,
        0.97222222222222221000,
        0.97297297297297303000,
        0.97368421052631582000,
        0.97435897435897434000,
        0.97499999999999998000,
        0.97560975609756095000,
        0.97619047619047616000,
        0.97674418604651159000,
        0.97727272727272729000,
        0.97777777777777775000,
        0.97826086956521741000,
        0.97872340425531912000,
        0.97916666666666663000,
        0.97959183673469385000,
        0.97999999999999998000,
        0.98039215686274506000,
        0.98076923076923073000,
        0.98113207547169812000,
        0.98148148148148151000,
        0.98181818181818181000,
        0.98214285714285710000,
        0.98245614035087714000,
        0.98275862068965514000,
        0.98305084745762716000,
        0.98333333333333328000,
        0.98360655737704916000,
        0.98387096774193550000,
        0.98412698412698418000,
        0.98437500000000000000,
        0.98461538461538467000,
        0.98484848484848486000,
        0.98507462686567160000,
        0.98529411764705888000,
        0.98550724637681164000,
        0.98571428571428577000,
        0.98591549295774650000,
        0.98611111111111116000,
        0.98630136986301364000,
        0.98648648648648651000,
        0.98666666666666669000,
        0.98684210526315785000,
        0.98701298701298701000,
        0.98717948717948723000,
        0.98734177215189878000,
        0.98750000000000004000,
        0.98765432098765427000,
        0.98780487804878048000,
        0.98795180722891562000,
        0.98809523809523814000,
        0.98823529411764710000,
        0.98837209302325579000,
        0.98850574712643680000,
        0.98863636363636365000,
        0.98876404494382020000,
        0.98888888888888893000,
        0.98901098901098905000,
        0.98913043478260865000,
        0.98924731182795700000,
        0.98936170212765961000,
        0.98947368421052628000,
        0.98958333333333337000,
        0.98969072164948457000,
        0.98979591836734693000,
        0.98989898989898994000,
        0.98999999999999999000,
        0.99009900990099009000,
        0.99019607843137258000,
        0.99029126213592233000,
        0.99038461538461542000,
        0.99047619047619051000,
        0.99056603773584906000,
        0.99065420560747663000,
        0.99074074074074070000,
        0.99082568807339455000,
        0.99090909090909096000,
        0.99099099099099097000,
        0.99107142857142860000,
        0.99115044247787609000,
        0.99122807017543857000,
        0.99130434782608701000,
        0.99137931034482762000,
        0.99145299145299148000,
        0.99152542372881358000,
        0.99159663865546221000,
        0.99166666666666670000,
        0.99173553719008267000,
        0.99180327868852458000,
        0.99186991869918695000,
        0.99193548387096775000,
        0.99199999999999999000,
        0.99206349206349209000,
        0.99212598425196852000,
        0.99218750000000000000,
        0.99224806201550386000,
        0.99230769230769234000,
        0.99236641221374045000,
        0.99242424242424243000,
        0.99248120300751874000,
        0.99253731343283580000,
        0.99259259259259258000,
        0.99264705882352944000,
        0.99270072992700731000,
        0.99275362318840576000,
        0.99280575539568350000,
        0.99285714285714288000,
        0.99290780141843971000,
        0.99295774647887325000,
        0.99300699300699302000,
        0.99305555555555558000,
        0.99310344827586206000,
        0.99315068493150682000,
        0.99319727891156462000,
        0.99324324324324320000,
        0.99328859060402686000,
        0.99333333333333329000,
        0.99337748344370858000,
        0.99342105263157898000,
        0.99346405228758172000,
        0.99350649350649356000,
        0.99354838709677418000,
        0.99358974358974361000,
        0.99363057324840764000,
        0.99367088607594933000,
        0.99371069182389937000,
        0.99375000000000002000,
        0.99378881987577639000,
        0.99382716049382713000,
        0.99386503067484666000,
        0.99390243902439024000,
        0.99393939393939390000,
        0.99397590361445787000,
        0.99401197604790414000,
        0.99404761904761907000,
        0.99408284023668636000,
        0.99411764705882355000,
        0.99415204678362579000,
        0.99418604651162790000,
        0.99421965317919070000,
        0.99425287356321834000,
        0.99428571428571433000,
        0.99431818181818177000,
        0.99435028248587576000,
        0.99438202247191010000,
        0.99441340782122900000,
        0.99444444444444446000,
        0.99447513812154698000,
        0.99450549450549453000,
        0.99453551912568305000,
        0.99456521739130432000,
        0.99459459459459465000,
        0.99462365591397850000,
        0.99465240641711228000,
        0.99468085106382975000,
        0.99470899470899465000,
        0.99473684210526314000,
        0.99476439790575921000,
        0.99479166666666663000,
        0.99481865284974091000,
        0.99484536082474229000,
        0.99487179487179489000,
        0.99489795918367352000,
        0.99492385786802029000,
        0.99494949494949492000,
        0.99497487437185927000,
        0.99500000000000000000,
        0.99502487562189057000,
        0.99504950495049505000,
        0.99507389162561577000,
        0.99509803921568629000,
        0.99512195121951219000,
        0.99514563106796117000,
        0.99516908212560384000,
        0.99519230769230771000,
        0.99521531100478466000,
        0.99523809523809526000,
        0.99526066350710896000,
        0.99528301886792447000,
        0.99530516431924887000,
        0.99532710280373837000,
        0.99534883720930234000,
        0.99537037037037035000,
        0.99539170506912444000,
        0.99541284403669728000,
        0.99543378995433796000,
        0.99545454545454548000,
        0.99547511312217196000,
        0.99549549549549554000,
        0.99551569506726456000,
        0.99553571428571430000,
        0.99555555555555553000,
        0.99557522123893805000,
        0.99559471365638763000,
        0.99561403508771928000,
        0.99563318777292575000,
        0.99565217391304350000,
        0.99567099567099571000,
        0.99568965517241381000,
        0.99570815450643779000,
        0.99572649572649574000,
        0.99574468085106382000,
        0.99576271186440679000,
        0.99578059071729963000,
        0.99579831932773111000,
        0.99581589958159000000,
        0.99583333333333335000,
        0.99585062240663902000,
        0.99586776859504134000,
        0.99588477366255146000,
        0.99590163934426235000,
        0.99591836734693873000,
        0.99593495934959353000,
        0.99595141700404854000,
        0.99596774193548387000,
        0.99598393574297184000,
        0.99600000000000000000,
        0.99601593625498008000,
        0.99603174603174605000,
        0.99604743083003955000,
        0.99606299212598426000,
        0.99607843137254903000,
        0.99609375000000000000,
        0.99610894941634243000,
        0.99612403100775193000,
        0.99613899613899615000,
        0.99615384615384617000,
        0.99616858237547889000,
        0.99618320610687028000,
        0.99619771863117867000,
        0.99621212121212122000,
        0.99622641509433962000,
        0.99624060150375937000,
        0.99625468164794007000,
        0.99626865671641796000,
        0.99628252788104088000,
        0.99629629629629635000,
        0.99630996309963105000,
        0.99632352941176472000,
        0.99633699633699635000,
        0.99635036496350360000,
        0.99636363636363634000,
        0.99637681159420288000,
        0.99638989169675085000,
        0.99640287769784175000,
        0.99641577060931896000,
        0.99642857142857144000,
        0.99644128113879005000,
        0.99645390070921991000,
        0.99646643109540634000,
        0.99647887323943662000,
        0.99649122807017543000,
        0.99650349650349646000,
        0.99651567944250874000,
        0.99652777777777779000,
        0.99653979238754320000,
        0.99655172413793103000,
        0.99656357388316152000,
        0.99657534246575341000,
        0.99658703071672350000,
        0.99659863945578231000,
        0.99661016949152548000,
        0.99662162162162160000,
        0.99663299663299665000,
        0.99664429530201337000,
        0.99665551839464883000,
        0.99666666666666670000,
        0.99667774086378735000,
        0.99668874172185429000,
        0.99669966996699666000,
        0.99671052631578949000,
        0.99672131147540988000,
        0.99673202614379086000,
        0.99674267100977199000,
        0.99675324675324672000,
        0.99676375404530748000,
        0.99677419354838714000,
        0.99678456591639875000,
        0.99679487179487181000,
        0.99680511182108622000,
        0.99681528662420382000,
        0.99682539682539684000,
        0.99683544303797467000,
        0.99684542586750791000,
        0.99685534591194969000,
        0.99686520376175547000,
        0.99687499999999996000,
        0.99688473520249221000,
        0.99689440993788825000,
        0.99690402476780182000,
        0.99691358024691357000,
        0.99692307692307691000,
        0.99693251533742333000,
        0.99694189602446481000,
        0.99695121951219512000,
        0.99696048632218848000,
        0.99696969696969695000,
        0.99697885196374625000,
        0.99698795180722888000,
        0.99699699699699695000,
        0.99700598802395213000,
        0.99701492537313430000,
        0.99702380952380953000,
        0.99703264094955490000,
        0.99704142011834318000,
        0.99705014749262533000,
        0.99705882352941178000,
        0.99706744868035191000,
        0.99707602339181289000,
        0.99708454810495628000,
        0.99709302325581395000,
        0.99710144927536237000,
        0.99710982658959535000,
        0.99711815561959649000,
        0.99712643678160917000,
        0.99713467048710602000,
        0.99714285714285711000,
        0.99715099715099720000,
        0.99715909090909094000,
        0.99716713881019825000,
        0.99717514124293782000,
        0.99718309859154930000,
        0.99719101123595510000,
        0.99719887955182074000,
        0.99720670391061450000,
        0.99721448467966578000,
        0.99722222222222223000,
        0.99722991689750695000,
        0.99723756906077343000,
        0.99724517906336085000,
        0.99725274725274726000,
        0.99726027397260275000,
        0.99726775956284153000,
        0.99727520435967298000,
        0.99728260869565222000,
        0.99728997289972898000,
        0.99729729729729732000,
        0.99730458221024254000,
        0.99731182795698925000,
        0.99731903485254692000,
        0.99732620320855614000,
        0.99733333333333329000,
        0.99734042553191493000,
        0.99734748010610075000,
        0.99735449735449733000,
        0.99736147757255933000,
        0.99736842105263157000,
        0.99737532808398954000,
        0.99738219895287961000,
        0.99738903394255873000,
        0.99739583333333337000,
        0.99740259740259740000,
        0.99740932642487046000,
        0.99741602067183466000,
        0.99742268041237114000,
        0.99742930591259638000,
        0.99743589743589745000,
        0.99744245524296671000,
        0.99744897959183676000,
        0.99745547073791352000,
        0.99746192893401020000,
        0.99746835443037973000,
        0.99747474747474751000,
        0.99748110831234260000,
        0.99748743718592969000,
        0.99749373433583965000,
        0.99750000000000005000,
        0.99750623441396513000,
        0.99751243781094523000,
        0.99751861042183620000,
        0.99752475247524752000,
        0.99753086419753090000,
        0.99753694581280783000,
        0.99754299754299758000,
        0.99754901960784315000,
        0.99755501222493892000,
        0.99756097560975610000,
        0.99756690997566910000,
        0.99757281553398058000,
        0.99757869249394671000,
        0.99758454106280192000,
        0.99759036144578317000,
        0.99759615384615385000,
        0.99760191846522783000,
        0.99760765550239239000,
        0.99761336515513122000,
        0.99761904761904763000,
        0.99762470308788598000,
        0.99763033175355453000,
        0.99763593380614657000,
        0.99764150943396224000,
        0.99764705882352944000,
        0.99765258215962438000,
        0.99765807962529274000,
        0.99766355140186913000,
        0.99766899766899764000,
        0.99767441860465111000,
        0.99767981438515085000,
        0.99768518518518523000,
        0.99769053117782913000,
        0.99769585253456217000,
        0.99770114942528731000,
        0.99770642201834858000,
        0.99771167048054921000,
        0.99771689497716898000,
        0.99772209567198178000,
        0.99772727272727268000,
        0.99773242630385484000,
        0.99773755656108598000,
        0.99774266365688491000,
        0.99774774774774777000,
        0.99775280898876406000,
        0.99775784753363228000,
        0.99776286353467558000,
        0.99776785714285710000,
        0.99777282850779514000,
        0.99777777777777776000,
        0.99778270509977829000,
        0.99778761061946908000,
        0.99779249448123619000,
        0.99779735682819382000,
        0.99780219780219781000,
        0.99780701754385970000,
        0.99781181619256021000,
        0.99781659388646293000,
        0.99782135076252720000,
        0.99782608695652175000,
        0.99783080260303691000,
        0.99783549783549785000,
        0.99784017278617709000,
        0.99784482758620685000,
        0.99784946236559136000,
        0.99785407725321884000,
        0.99785867237687365000,
        0.99786324786324787000,
        0.99786780383795304000,
        0.99787234042553197000,
        0.99787685774946921000,
        0.99788135593220340000,
        0.99788583509513740000,
        0.99789029535864981000,
        0.99789473684210528000,
        0.99789915966386555000,
        0.99790356394129975000,
        0.99790794979079500000,
        0.99791231732776620000,
        0.99791666666666667000,
        0.99792099792099798000,
        0.99792531120331951000,
        0.99792960662525876000,
        0.99793388429752061000,
        0.99793814432989691000,
        0.99794238683127567000,
        0.99794661190965095000,
        0.99795081967213117000,
        0.99795501022494892000,
        0.99795918367346936000,
        0.99796334012219956000,
        0.99796747967479671000,
        0.99797160243407712000,
        0.99797570850202433000,
        0.99797979797979797000,
        0.99798387096774188000,
        0.99798792756539234000,
        0.99799196787148592000,
        0.99799599198396793000,
        0.99800000000000000000,
        0.99800399201596801000,
        0.99800796812749004000,
        0.99801192842942343000,
        0.99801587301587302000,
        0.99801980198019802000,
        0.99802371541501977000,
        0.99802761341222879000,
        0.99803149606299213000,
        0.99803536345776034000,
        0.99803921568627452000,
        0.99804305283757344000,
        0.99804687500000000000,
        0.99805068226120852000,
        0.99805447470817121000,
        0.99805825242718449000,
        0.99806201550387597000,
        0.99806576402321079000,
        0.99806949806949807000,
        0.99807321772639690000,
        0.99807692307692308000,
        0.99808061420345484000,
        0.99808429118773945000,
        0.99808795411089868000,
        0.99809160305343514000,
        0.99809523809523815000,
        0.99809885931558939000,
        0.99810246679316883000,
        0.99810606060606055000,
        0.99810964083175802000,
        0.99811320754716981000,
        0.99811676082862522000,
        0.99812030075187974000,
        0.99812382739212002000,
        0.99812734082397003000,
        0.99813084112149530000,
        0.99813432835820892000,
        0.99813780260707630000,
        0.99814126394052050000,
        0.99814471243042668000,
        0.99814814814814812000,
        0.99815157116451014000,
        0.99815498154981552000,
        0.99815837937384899000,
        0.99816176470588236000,
        0.99816513761467895000,
        0.99816849816849818000,
        0.99817184643510060000,
        0.99817518248175185000,
        0.99817850637522765000,
        0.99818181818181817000,
        0.99818511796733211000,
        0.99818840579710144000,
        0.99819168173598549000,
        0.99819494584837543000,
        0.99819819819819822000,
        0.99820143884892087000,
        0.99820466786355477000,
        0.99820788530465954000,
        0.99821109123434704000,
        0.99821428571428572000,
        0.99821746880570406000,
        0.99822064056939497000,
        0.99822380106571940000,
        0.99822695035460995000,
        0.99823008849557526000,
        0.99823321554770317000,
        0.99823633156966496000,
        0.99823943661971826000,
        0.99824253075571179000,
        0.99824561403508771000,
        0.99824868651488619000,
        0.99825174825174823000,
        0.99825479930191974000,
        0.99825783972125437000,
        0.99826086956521742000,
        0.99826388888888884000,
        0.99826689774696709000,
        0.99826989619377160000,
        0.99827288428324701000,
        0.99827586206896557000,
        0.99827882960413084000,
        0.99828178694158076000,
        0.99828473413379071000,
        0.99828767123287676000,
        0.99829059829059830000,
        0.99829351535836175000,
        0.99829642248722317000,
        0.99829931972789121000,
        0.99830220713073003000,
        0.99830508474576274000,
        0.99830795262267347000,
        0.99831081081081086000,
        0.99831365935919059000,
        0.99831649831649827000,
        0.99831932773109244000,
        0.99832214765100669000,
        0.99832495812395305000,
        0.99832775919732442000,
        0.99833055091819700000,
        0.99833333333333329000,
        0.99833610648918469000,
        0.99833887043189373000,
        0.99834162520729686000,
        0.99834437086092720000,
        0.99834710743801658000,
        0.99834983498349839000,
        0.99835255354200991000,
        0.99835526315789469000,
        0.99835796387520526000,
        0.99836065573770494000,
        0.99836333878887074000,
        0.99836601307189543000,
        0.99836867862969003000,
        0.99837133550488599000,
        0.99837398373983743000,
        0.99837662337662336000,
        0.99837925445705022000,
        0.99838187702265369000,
        0.99838449111470118000,
        0.99838709677419357000,
        0.99838969404186795000,
        0.99839228295819937000,
        0.99839486356340290000,
        0.99839743589743590000,
        0.99839999999999995000,
        0.99840255591054317000,
        0.99840510366826152000,
        0.99840764331210186000,
        0.99841017488076311000,
        0.99841269841269842000,
        0.99841521394611732000,
        0.99841772151898733000,
        0.99842022116903628000,
        0.99842271293375395000,
        0.99842519685039366000,
        0.99842767295597479000,
        0.99843014128728413000,
        0.99843260188087779000,
        0.99843505477308292000,
        0.99843749999999998000,
        0.99843993759750393000,
        0.99844236760124616000,
        0.99844479004665632000,
        0.99844720496894412000,
        0.99844961240310082000,
        0.99845201238390091000,
        0.99845440494590421000,
        0.99845679012345678000,
        0.99845916795069334000,
        0.99846153846153851000,
        0.99846390168970811000,
        0.99846625766871167000,
        0.99846860643185298000,
        0.99847094801223246000,
        0.99847328244274813000,
        0.99847560975609762000,
        0.99847792998477924000,
        0.99848024316109418000,
        0.99848254931714719000,
        0.99848484848484853000,
        0.99848714069591527000,
        0.99848942598187307000,
        0.99849170437405732000,
        0.99849397590361444000,
        0.99849624060150377000,
        0.99849849849849848000,
        0.99850074962518742000,
        0.99850299401197606000,
        0.99850523168908822000,
        0.99850746268656720000,
        0.99850968703427723000,
        0.99851190476190477000,
        0.99851411589895989000,
        0.99851632047477745000,
        0.99851851851851847000,
        0.99852071005917165000,
        0.99852289512555392000,
        0.99852507374631272000,
        0.99852724594992637000,
        0.99852941176470589000,
        0.99853157121879588000,
        0.99853372434017595000,
        0.99853587115666176000,
        0.99853801169590639000,
        0.99854014598540142000,
        0.99854227405247808000,
        0.99854439592430855000,
        0.99854651162790697000,
        0.99854862119013066000,
        0.99855072463768113000,
        0.99855282199710560000,
        0.99855491329479773000,
        0.99855699855699853000,
        0.99855907780979825000,
        0.99856115107913668000,
        0.99856321839080464000,
        0.99856527977044474000,
        0.99856733524355301000,
        0.99856938483547930000,
        0.99857142857142855000,
        0.99857346647646217000,
        0.99857549857549854000,
        0.99857752489331442000,
        0.99857954545454541000,
        0.99858156028368794000,
        0.99858356940509918000,
        0.99858557284299854000,
        0.99858757062146897000,
        0.99858956276445698000,
        0.99859154929577465000,
        0.99859353023909991000,
        0.99859550561797750000,
        0.99859747545582045000,
        0.99859943977591037000,
        0.99860139860139863000,
        0.99860335195530725000,
        0.99860529986053004000,
        0.99860724233983289000,
        0.99860917941585536000,
        0.99861111111111112000,
        0.99861303744798890000,
        0.99861495844875348000,
        0.99861687413554634000,
        0.99861878453038677000,
        0.99862068965517237000,
        0.99862258953168048000,
        0.99862448418156813000,
        0.99862637362637363000,
        0.99862825788751719000,
        0.99863013698630132000,
        0.99863201094391241000,
        0.99863387978142082000,
        0.99863574351978168000,
        0.99863760217983655000,
        0.99863945578231295000,
        0.99864130434782605000,
        0.99864314789687925000,
        0.99864498644986455000,
        0.99864682002706362000,
        0.99864864864864866000,
        0.99865047233468285000,
        0.99865229110512133000,
        0.99865410497981155000,
        0.99865591397849462000,
        0.99865771812080539000,
        0.99865951742627346000,
        0.99866131191432395000,
        0.99866310160427807000,
        0.99866488651535379000,
        0.99866666666666670000,
        0.99866844207723038000,
        0.99867021276595747000,
        0.99867197875166003000,
        0.99867374005305043000,
        0.99867549668874167000,
        0.99867724867724872000,
        0.99867899603698806000,
        0.99868073878627972000,
        0.99868247694334655000,
        0.99868421052631584000,
        0.99868593955321949000,
        0.99868766404199472000,
        0.99868938401048490000,
        0.99869109947643975000,
        0.99869281045751634000,
        0.99869451697127942000,
        0.99869621903520212000,
        0.99869791666666663000,
        0.99869960988296491000,
        0.99870129870129876000,
        0.99870298313878081000,
        0.99870466321243523000,
        0.99870633893919791000,
        0.99870801033591727000,
        0.99870967741935479000,
        0.99871134020618557000,
        0.99871299871299868000,
        0.99871465295629824000,
        0.99871630295250324000,
        0.99871794871794872000,
        0.99871959026888601000,
        0.99872122762148341000,
        0.99872286079182626000,
        0.99872448979591832000,
        0.99872611464968153000,
        0.99872773536895676000,
        0.99872935196950441000,
        0.99873096446700504000,
        0.99873257287705952000,
        0.99873417721518987000,
        0.99873577749683939000,
        0.99873737373737370000,
        0.99873896595208067000,
        0.99874055415617125000,
        0.99874213836477987000,
        0.99874371859296485000,
        0.99874529485570895000,
        0.99874686716791983000,
        0.99874843554443049000,
        0.99875000000000003000,
        0.99875156054931336000,
        0.99875311720698257000,
        0.99875466998754669000,
        0.99875621890547261000,
        0.99875776397515525000,
        0.99875930521091816000,
        0.99876084262701359000,
        0.99876237623762376000,
        0.99876390605686027000,
        0.99876543209876545000,
        0.99876695437731200000,
        0.99876847290640391000,
        0.99876998769987702000,
        0.99877149877149873000,
        0.99877300613496933000,
        0.99877450980392157000,
        0.99877600979192172000,
        0.99877750611246940000,
        0.99877899877899878000,
        0.99878048780487805000,
        0.99878197320341044000,
        0.99878345498783450000,
        0.99878493317132444000,
        0.99878640776699024000,
        0.99878787878787878000,
        0.99878934624697335000,
        0.99879081015719473000,
        0.99879227053140096000,
        0.99879372738238847000,
        0.99879518072289153000,
        0.99879663056558365000,
        0.99879807692307687000,
        0.99879951980792314000,
        0.99880095923261392000,
        0.99880239520958081000,
        0.99880382775119614000,
        0.99880525686977295000,
        0.99880668257756566000,
        0.99880810488676997000,
        0.99880952380952381000,
        0.99881093935790721000,
        0.99881235154394299000,
        0.99881376037959668000,
        0.99881516587677721000,
        0.99881656804733732000,
        0.99881796690307334000,
        0.99881936245572611000,
        0.99882075471698117000,
        0.99882214369846878000,
        0.99882352941176467000,
        0.99882491186839018000,
        0.99882629107981225000,
        0.99882766705744430000,
        0.99882903981264637000,
        0.99883040935672518000,
        0.99883177570093462000,
        0.99883313885647607000,
        0.99883449883449882000,
        0.99883585564610011000,
        0.99883720930232556000,
        0.99883855981416958000,
        0.99883990719257543000,
        0.99884125144843572000,
        0.99884259259259256000,
        0.99884393063583810000,
        0.99884526558891451000,
        0.99884659746251436000,
        0.99884792626728114000,
        0.99884925201380903000,
        0.99885057471264371000,
        0.99885189437428246000,
        0.99885321100917435000,
        0.99885452462772051000,
        0.99885583524027455000,
        0.99885714285714289000,
        0.99885844748858443000,
        0.99885974914481190000,
        0.99886104783599083000,
        0.99886234357224113000,
        0.99886363636363640000,
        0.99886492622020429000,
        0.99886621315192747000,
        0.99886749716874290000,
        0.99886877828054299000,
        0.99887005649717520000,
        0.99887133182844245000,
        0.99887260428410374000,
        0.99887387387387383000,
        0.99887514060742411000,
        0.99887640449438198000,
        0.99887766554433222000,
        0.99887892376681620000,
        0.99888017917133254000,
        0.99888143176733779000,
        0.99888268156424576000,
        0.99888392857142860000,
        0.99888517279821631000,
        0.99888641425389757000,
        0.99888765294771964000,
        0.99888888888888894000,
        0.99889012208657046000,
        0.99889135254988914000,
        0.99889258028792915000,
        0.99889380530973448000,
        0.99889502762430937000,
        0.99889624724061810000,
        0.99889746416758540000,
        0.99889867841409696000,
        0.99889988998899892000,
        0.99890109890109891000,
        0.99890230515916578000,
        0.99890350877192979000,
        0.99890470974808321000,
        0.99890590809628010000,
        0.99890710382513659000,
        0.99890829694323147000,
        0.99890948745910579000,
        0.99891067538126366000,
        0.99891186071817195000,
        0.99891304347826082000,
        0.99891422366992400000,
        0.99891540130151846000,
        0.99891657638136511000,
        0.99891774891774887000,
        0.99891891891891893000,
        0.99892008639308860000,
        0.99892125134843579000,
        0.99892241379310343000,
        0.99892357373519913000,
        0.99892473118279568000,
        0.99892588614393130000,
        0.99892703862660948000,
        0.99892818863879962000,
        0.99892933618843682000,
        0.99893048128342243000,
        0.99893162393162394000,
        0.99893276414087517000,
        0.99893390191897657000,
        0.99893503727369537000,
        0.99893617021276593000,
        0.99893730074388953000,
        0.99893842887473461000,
        0.99893955461293749000,
        0.99894067796610164000,
        0.99894179894179891000,
        0.99894291754756870000,
        0.99894403379091867000,
        0.99894514767932485000,
        0.99894625922023184000,
        0.99894736842105258000,
        0.99894847528916930000,
        0.99894957983193278000,
        0.99895068205666315000,
        0.99895178197064993000,
        0.99895287958115186000,
        0.99895397489539750000,
        0.99895506792058519000,
        0.99895615866388310000,
        0.99895724713242962000,
        0.99895833333333328000,
        0.99895941727367321000,
        0.99896049896049899000,
        0.99896157840083077000,
        0.99896265560165975000,
        0.99896373056994814000,
        0.99896480331262938000,
        0.99896587383660806000,
        0.99896694214876036000,
        0.99896800825593390000,
        0.99896907216494846000,
        0.99897013388259526000,
        0.99897119341563789000,
        0.99897225077081198000,
        0.99897330595482547000,
        0.99897435897435893000,
        0.99897540983606559000,
        0.99897645854657113000,
        0.99897750511247441000,
        0.99897854954034726000,
        0.99897959183673468000,
        0.99898063200815490000,
        0.99898167006109984000,
        0.99898270600203454000,
        0.99898373983739841000,
        0.99898477157360410000,
        0.99898580121703850000,
        0.99898682877406286000,
        0.99898785425101211000,
        0.99898887765419619000,
        0.99898989898989898000,
        0.99899091826437947000,
        0.99899193548387100000,
        0.99899295065458205000,
        0.99899396378269623000,
        0.99899497487437183000,
        0.99899598393574296000,
        0.99899699097291872000,
        0.99899799599198402000,
        0.99899899899899902000,
        0.99900000000000000000,
        0.99900099900099903000,
        0.99900199600798401000,
        0.99900299102691925000,
        0.99900398406374502000,
        0.99900497512437814000,
        0.99900596421471177000,
        0.99900695134061568000,
        0.99900793650793651000,
        0.99900891972249750000,
        0.99900990099009901000,
        0.99901088031651830000,
        0.99901185770750989000,
        0.99901283316880551000,
        0.99901380670611439000,
        0.99901477832512320000,
        0.99901574803149606000,
        0.99901671583087515000,
        0.99901768172888017000,
        0.99901864573110888000,
        0.99901960784313726000,
        0.99902056807051909000,
        0.99902152641878672000,
        0.99902248289345064000,
    ];

    [ThreadStatic]
    private static Point? s_cachedPoint;

    /// <summary>
    ///     Approximates the definite integral of a function over a finite interval.
    /// </summary>
    /// <param name="f">The function to integrate.</param>
    /// <param name="intervalBegin">The start of the integration interval.</param>
    /// <param name="intervalEnd">The end of the integration interval.</param>
    /// <param name="order">The quadrature order (number of evaluation points).</param>
    /// <returns>The approximate integral value.</returns>
    public static double Integrate(Func<double, double> f, double intervalBegin, double intervalEnd, int order)
    {
        Point point = GetPoint(order);

        int m = (order + 1) >> 1;
        double a = 0.5 * (intervalEnd - intervalBegin);
        double b = 0.5 * (intervalEnd + intervalBegin);

        double[] weights = point.Weights;
        double[] abscissas = point.Abscissas;

        double sum;
        if ((order & 1) != 0)
        {
            sum = weights[0] * f(b);
            for (int i = 1; i < m; i++)
            {
                double ax = a * abscissas[i];
                sum += weights[i] * (f(b + ax) + f(b - ax));
            }
        }
        else
        {
            sum = 0.0;
            for (int i = 0; i < m; i++)
            {
                double ax = a * abscissas[i];
                sum += weights[i] * (f(b + ax) + f(b - ax));
            }
        }

        return a * sum;
    }

    private static Point GetPoint(int order)
    {
        bool isCached = s_cachedPoint is { } cachedPoint && cachedPoint.Order == order;
        if (!isCached)
        {
            if (!s_precomputedPoints.TryGetValue(order, out Point? point))
            {
                point = GeneratePoint(order, 1e-10);
            }

            s_cachedPoint = point;
        }

        return s_cachedPoint!;
    }

    private static Point GeneratePoint(int order, double eps)
    {
        const double pi = 3.1415926535897932384626433832795028841971693993751;

        double w0 = 0;
        int m = (order + 1) >> 1;
        double[] abscissas = new double[m];
        double[] weights = new double[m];
        double t0 = 1.0 - (1.0 - 1.0 / order) / (8.0 * order * order);
        double t1 = 1.0 / (4.0 * order + 2.0);

        for (int i = 1; i <= m; i++)
        {
            int j = 0;
            double x0 = Math.Cos(pi * ((i << 2) - 1) * t1) * t0;
            double x1;
            double dx;
            double w1;
            double dw;

            do
            {
                double p1 = 1.0;
                double p0 = x0;
                double p2;
                int k;
                double t2;

                if (order < s_legendreLookupTable.Length)
                {
                    for (k = 2; k <= order; k++)
                    {
                        p2 = p1;
                        p1 = p0;
                        t2 = x0 * p1;

                        p0 = t2 + s_legendreLookupTable[k] * (t2 - p2);
                    }
                }
                else
                {
                    for (k = 2; k < s_legendreLookupTable.Length; k++)
                    {
                        p2 = p1;
                        p1 = p0;
                        t2 = x0 * p1;

                        p0 = t2 + s_legendreLookupTable[k] * (t2 - p2);
                    }

                    for (k = s_legendreLookupTable.Length; k <= order; k++)
                    {
                        p2 = p1;
                        p1 = p0;
                        t2 = x0 * p1;
                        double t3 = (k - 1.0) / k;

                        p0 = t2 + t3 * (t2 - p2);
                    }
                }

                double dpdx = (x0 * p0 - p1) * order / (x0 * x0 - 1.0);

                x1 = x0 - p0 / dpdx;
                w1 = 2.0 / ((1.0 - x1 * x1) * dpdx * dpdx);

                if (j == 0)
                {
                    w0 = 2.0 / ((1.0 - x0 * x0) * dpdx * dpdx);
                }

                dx = x0 - x1;
                dw = w0 - w1;

                x0 = x1;
                w0 = w1;
                j++;
            }
            while ((Math.Abs(dx) > eps || Math.Abs(dw) > eps) && j < 100);

            int index = m - 1 - (i - 1);

            abscissas[index] = x1;
            weights[index] = w1;
        }

        return new Point(order, abscissas, weights);
    }

    private sealed record Point(int Order, double[] Abscissas, double[] Weights);
}
